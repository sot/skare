NAME = skare
VERSION = 0.04
PREFIX = @prefix@

all: basedirs python perl perl_dbi wcstools

except_python: basedirs perl perl_dbi

basedirs:
	./install.py --prefix $(PREFIX) --config template.cfg

# Optional packages in support of python modules

hdf5:
	./install.py --prefix $(PREFIX) --config env_vars.cfg --config hdf5.cfg 

num_libs:
	./install.py --prefix $(PREFIX) --config env_vars.cfg --config num_libs.cfg 

wcstools:
	./install.py --prefix $(PREFIX) --config env_vars.cfg --config wcstools.cfg 

pycuda:
	./install.py --prefix $(PREFIX) --config env_vars.cfg --config pycuda.cfg

# Base python

python:
	./install.py --prefix $(PREFIX) --config env_vars.cfg \
	--config xtime.cfg \
	--config python.cfg \
	--config meld.cfg

# Perl

perl:
	./install.py --prefix $(PREFIX) --config env_vars.cfg \
	--config xtime.cfg \
	--config cfitsio.cfg \
	--config pgplot.cfg \
	--config perl_modules.cfg 

perl_dbi:
	./install.py --prefix $(PREFIX) --config env_vars.cfg --config perl_dbi.cfg

dist:
	mkdir $(NAME)-$(VERSION)
	mkdir -p dist
	tar --exclude .svn --exclude "*.pyc" --exclude "*~" --create --files-from=MANIFEST --file - \
	 | (tar --extract --directory $(NAME)-$(VERSION) --file - )
	tar --create --verbose --gzip --file dist/$(NAME)-$(VERSION).tar.gz $(NAME)-$(VERSION)
	rm -rf $(NAME)-$(VERSION)

